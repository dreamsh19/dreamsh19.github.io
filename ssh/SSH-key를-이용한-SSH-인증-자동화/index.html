<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>SSH key를 이용한 SSH 인증 자동화 - 기술을 기술하다</title>
<meta name="description" content="이슈">


  <meta name="author" content="ㅎㅅㅎ">
  
  <meta property="article:author" content="ㅎㅅㅎ">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="기술을 기술하다">
<meta property="og:title" content="SSH key를 이용한 SSH 인증 자동화">
<meta property="og:url" content="https://dreamsh19.github.io/ssh/SSH-key%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-SSH-%EC%9D%B8%EC%A6%9D-%EC%9E%90%EB%8F%99%ED%99%94/">


  <meta property="og:description" content="이슈">







  <meta property="article:published_time" content="2021-06-13T00:00:00+09:00">





  

  


<link rel="canonical" href="https://dreamsh19.github.io/ssh/SSH-key%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-SSH-%EC%9D%B8%EC%A6%9D-%EC%9E%90%EB%8F%99%ED%99%94/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "서버 개발자",
      "url": "https://dreamsh19.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="기술을 기술하다 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          기술을 기술하다
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">ㅎㅅㅎ</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Backend Dev</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">South Korea</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/dreamsh19" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/dreamsh19" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
        
      

      

      
        <li>
          <a href="mailto:dreamsh19@gmail.com">
            <meta itemprop="email" content="dreamsh19@gmail.com">
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  <a href="https://hits.seeyoufarm.com" style="display: none;">
    <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fdreamsh19.github.io&count_bg=%2348AFB3&title_bg=%237D8B8E&icon=&icon_color=%23360E0E&title=hits&edge_flat=false">
  </a>  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="SSH key를 이용한 SSH 인증 자동화">
    <meta itemprop="description" content="이슈">
    <meta itemprop="datePublished" content="2021-06-13T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">SSH key를 이용한 SSH 인증 자동화
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
<li><a href="#%EC%9D%B4%EC%8A%88">이슈</a></li>
<li>
<a href="#ssh-key%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%9D%B8%EC%A6%9D">SSH key를 이용한 인증</a><ul>
<li><a href="#1-ssh-key-%EC%83%9D%EC%84%B1">1. ssh key 생성</a></li>
<li><a href="#2-ssh-key-%EB%B3%B5%EC%82%AC">2. ssh key 복사</a></li>
<li><a href="#3-ssh-%EC%A0%91%EC%86%8D">3. ssh 접속</a></li>
</ul>
</li>
<li><a href="#ansible%EC%97%90%EC%84%9C%EC%9D%98-%ED%99%9C%EC%9A%A9">Ansible에서의 활용</a></li>
<li><a href="#references">References</a></li>
</ul>

            </nav>
          </aside>
        
        <h2 id="이슈">이슈</h2>

<p>ssh를 이용하여 원격 서버(주로 게이트웨이 서버)를 매번 접속하는데 접속할 때마다 계정, 도메인, 비밀번호를 매번 치는 게 번거로웠다. 그래서 이를 자동화하기 위한 스크립트를 만들면 좋을 것 같다는 생각이 들었다. 처음에는 패스워드를 스크립트로 입력하도록 하는 자동화를 생각하며 방법을 찾아보았으나 패스워드 없이 ssh key를 이용하여 로그인하는 방법이 있다는 걸 알게 되었고, 그 방법이 더 좋아보여서 블로그에 남기고자 한다. 추가적으로 ansible에서 활용 가능성까지 다루고자 한다.</p>

<h2 id="ssh-key를-이용한-인증">SSH key를 이용한 인증</h2>

<p>우선 ssh를 이용하여 로컬 서버에서, 원격의  <code class="language-plaintext highlighter-rouge">remote.com</code> 서버의 <code class="language-plaintext highlighter-rouge">irteam</code> 계정으로 접속하고자 하는 상황을 생각해보자.</p>

<p>접속을 시도하는 쪽이 꼭 로컬 서버일 필요는 없지만(로컬 서버에서 또 다른 로컬 서버로 접속하는 경우) 이 글에서는 편의상 접속을 시도하는 쪽을 로컬 서버, 접속 대상이 되는 쪽을 리모트 서버라고 칭하려고 한다.</p>

<p>로컬 서버에서</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh irteam@remote.com
</code></pre></div></div>
<p>의 명령어 입력후 패스워드까지 입력해서 인증 과정을 거쳐 패스워드가 일치하면 원격 접속에 성공하게 된다.</p>

<p>그러나 ssh key를 이용하면 패스워드 대신 ssh key를 이용하여 인증을 진행하여 접속 가능 여부를 판단한다.</p>

<h3 id="1-ssh-key-생성">1. ssh key 생성</h3>

<p>접속을 시도하는 로컬 서버에서 최초(기존에 ssh key를 생성한 적이 없는 경우)에 아래의 명령어를 통해 ssh key를 생성해야한다. 기존에 ssh key가 존재하는 경우 이 과정을 생략가능하다.  일종에 자신을 나타내는 id를 만드는 과정으로 생각할 수 있다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 2048
</code></pre></div></div>

<p>그럼 아래와 같은 내용이 출력되는데, ssh key를 어디에 저장할지 등등 설정에 관한 내용이다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Generating public/private rsa key pair.
Enter file <span class="k">in </span>which to save the key <span class="o">(</span>/home/username/.ssh/id_rsa<span class="o">)</span>: 
Enter passphrase <span class="o">(</span>empty <span class="k">for </span>no passphrase<span class="o">)</span>: 
Enter same passphrase again: 
Your identification has been saved <span class="k">in</span> /home/username/.ssh/id_rsa.
Your public key has been saved <span class="k">in</span> /home/username/.ssh/id_rsa.pub.
</code></pre></div></div>

<p>특별히 지정이 필요한 경우가 아니라면, 아무 내용을 입력하지 않고 엔터를 입력하면 디폴트 값이 적용되므로, 엔터를 연타해준다</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> ~/.ssh
authorized_keys id_rsa          id_rsa.pub      known_hosts
</code></pre></div></div>

<p>그러면 홈 디렉토리(~) 아래 .ssh 디렉토리 안에 <code class="language-plaintext highlighter-rouge">id_rsa</code>, <code class="language-plaintext highlighter-rouge">id_rsa.pub</code>가 생성된 걸 확인할 수 있다. 각각 private key와 public key를 저장하고 있다.</p>

<h3 id="2-ssh-key-복사">2. ssh key 복사</h3>

<p>위에서 생성한 로컬 서버의 ssh key 중 공개키(public key)를 리모트 서버에 전달하는 과정이 필요하다. 앞으로 이 공개키를 이용하여 통신을 할 것이니 리모트 서버에 그 키를 저장하는 과정 정도로 볼 수 있다. 로컬 서버에서 아래와 같은 명령어로 로컬 서버의 공개키를 리모트 서버에 전달할 수 있다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh-copy-id irteam@remote.com
irteam@remote.com<span class="s1">'s password: 
</span></code></pre></div></div>

<p>최초 인증이기 때문에 패스워드를 입력하면 공개키 복사가 완료된다.</p>

<h3 id="3-ssh-접속">3. ssh 접속</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh irteam@remote.com
</code></pre></div></div>

<p>공개키를 전달한 후 로컬 서버에서 ssh로 접속시 더 이상 패스워드를 묻지 않고 접속에 성공하게 된다!</p>

<p>추가적으로 리모트 서버에서 아래 명령어를 입력시</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat</span> ~/.ssh/authorized_keys
</code></pre></div></div>

<p>로컬 서버의 공개키(<code class="language-plaintext highlighter-rouge">id_rsa.pub</code>에 저장되어 있던 키)가 저장되어 있는 것을 확인할 수 있다.</p>

<h2 id="ansible에서의-활용">Ansible에서의 활용</h2>

<p><a href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a>은 ssh를 기반으로 여러 호스트에 명령을 하달하는 소프트웨어로, 원격으로 여러 서버에서 배포를 자동화할때 주로 쓰인다.</p>

<p>이때 여러 호스트에 접속시 패스워드가 필요하기 때문에 플레이북 작성 시 인증 과정을 포함하는 경우가 있다. 그런데 위의 ssh key를 사전에 등록해놓으면 패스워드 입력없이 ssh로 원격 호스트에 접속이 가능하다. 따라서 접속 대상이 되는 호스트들에 대해 ssh key를 사전에 등록함으로써 플레이북에서 인증 과정을 제거할 수 있다. Ansible을 이용해 접속하는 호스트(예를 들어 배포 대상이 되는 서버)들의 경우 일반적으로 그 대상이 결정이 되어있고, 자주 변하는 정보가 아니기 때문에 ssk key를 이용한 인증을 유용하게 사용할 수 있다.</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://serverfault.com/questions/241588/how-to-automate-ssh-login-with-password">https://serverfault.com/questions/241588/how-to-automate-ssh-login-with-password</a></li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#automation" class="page__taxonomy-item" rel="tag">automation</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#ssh" class="page__taxonomy-item" rel="tag">ssh</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#ssh" class="page__taxonomy-item" rel="tag">ssh</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-06-13T00:00:00+09:00">June 13, 2021</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=SSH+key%EB%A5%BC+%EC%9D%B4%EC%9A%A9%ED%95%9C+SSH+%EC%9D%B8%EC%A6%9D+%EC%9E%90%EB%8F%99%ED%99%94%20https%3A%2F%2Fdreamsh19.github.io%2Fssh%2FSSH-key%25EB%25A5%25BC-%25EC%259D%25B4%25EC%259A%25A9%25ED%2595%259C-SSH-%25EC%259D%25B8%25EC%25A6%259D-%25EC%259E%2590%25EB%258F%2599%25ED%2599%2594%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdreamsh19.github.io%2Fssh%2FSSH-key%25EB%25A5%25BC-%25EC%259D%25B4%25EC%259A%25A9%25ED%2595%259C-SSH-%25EC%259D%25B8%25EC%25A6%259D-%25EC%259E%2590%25EB%258F%2599%25ED%2599%2594%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fdreamsh19.github.io%2Fssh%2FSSH-key%25EB%25A5%25BC-%25EC%259D%25B4%25EC%259A%25A9%25ED%2595%259C-SSH-%25EC%259D%25B8%25EC%25A6%259D-%25EC%259E%2590%25EB%258F%2599%25ED%2599%2594%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/nginx/Nginx-414-Request-URI-Too-Large/" class="pagination--pager" title="Nginx 414 Request Uri Too Large
">Previous</a>
    
    
      <a href="/blog/%EB%B8%94%EB%A1%9C%EA%B7%B8%EB%A5%BC-%EB%8B%A4%EC%8B%9C-%EC%8B%9C%EC%9E%91%ED%95%98%EB%A9%B0/" class="pagination--pager" title="블로그를 다시 시작하며
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/dreamsh19" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
        
          <li><a href="https://www.linkedin.com/in/dreamsh19" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2025 서버 개발자. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LM91QEFQ4D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LM91QEFQ4D', { 'anonymize_ip': false});
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://dreamsh19.github.io/ssh/SSH-key%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-SSH-%EC%9D%B8%EC%A6%9D-%EC%9E%90%EB%8F%99%ED%99%94/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/ssh/SSH-key를-이용한-SSH-인증-자동화"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://dreamsh19-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>


  





  </body>
</html>
